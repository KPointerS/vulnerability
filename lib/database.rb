
require "sqlite3"


module Vulnerability
  class Database
    def initialize
      @db = SQLite3::Database.new "vulnerabilities.db"
      @db_name = "vulnerabilities_db"
      setup
    end

    def setup
      db.execute <<-SQL
        CREATE TABLE #{@db_name} (
          id     INTEGER PRIMARY KEY AUTOINCREMENT,
          name   TEXT NOT NULL,
          desc   TEXT,
          level  INTEGER
      );
      SQL
    end

    def add(vuln={})
      @db.execute("INSERT INTO #{@db_name} ( name, desc, level ) VALUES (?, ?, ?)",
                  [vuln[:name], vuln[:desc], vuln[:level]])
    end

    def delete
      @db.execute("INSERT INTO #{@db_name} ( name, desc, level ) VALUES (?, ?, ?)",
              [vuln[:name], vuln[:desc], vuln[:level]])
    end

    def list
      @db.execute "SELECT id, name, desc, level FROM #{@db_name}"
    end

  end
end



